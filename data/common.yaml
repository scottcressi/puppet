---
classes:
  - motd

resource_tree::collections:
  base-logs:
    filebeat::input:
      'syslogs':
        paths: [
          '/var/log/secure',
        ]

# company
company: 'example'

# puppet agent
puppet_agent::package_version: '6.18.0'
puppet_agent::service_names: ['puppet']
puppet_agent::collection: 'puppet6'

# SSH
ssh::server_options:
  PrintMotd: 'yes'
  Ciphers:
    'aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com'
  MACs:
    'hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160'
ssh::storeconfigs_enabled: false

# selinux
selinux::mode: 'permissive'

# filebeat
filebeat::outputs:
  logstash:
    hosts: ['%{hiera("elk_logstash")}:5044']
# filebeat
filebeat::logging:
  level: warning
filebeat::major_version: '7'
filebeat::package_ensure: '7.9.0'
filebeat::service_provider: 'systemd'
